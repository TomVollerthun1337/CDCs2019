<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>CDCs für otto.de</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css">
		<link rel="stylesheet" href="plugin/title-footer/title-footer.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<style>
			.reveal section img {
				box-shadow: none;
				border: none;
			}
			.reveal #title-footer {
		    bottom: calc(3px + 2.5vh) !important;
		    height: 3vh;
			}
		</style>

	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section class='title' data-state='no-title-footer'>
						<h1>CDCs für otto.de</h1>
						<p>Continuous Everything (jetzt mit Cloud™)</p>
						<p>Tom Vollerthun</p>
						<img src="img/otto_logo_2015.png"/>
					</section>
			    <section>
			      <img class="stretch" src="img/Erster_Otto-Katalog.jpg"/>
						<aside class="notes">
							<ul>
								<li>1950</li>
								<li>Auflage: 300</li>
								<li>14 Seiten, 28 Schuhe</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/erster_computer_1961.jpg"/>
						<aside class="notes">
							<ul>
								<li>1961</li>
								<li>Univac III</li>
								<li>Host-Ablösung Sprint-Projekt 2016</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode1995.jpg"/>
						<aside class="notes">
							<ul>
								<li>1995</li>
								<li>Nur Werbung für CD-Rom</li>
								<li>"Beste Anzeigeergebnisse mit Netscape und 800x600 Punkten!"</li>
								<li>Deployments: halbjährlich</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode2000.png"/>
						<aside class="notes">
							<ul>
								<li>1995</li>
								<li>Oracle und PL-SQL</li>
								<li>Richtiger Shop, sogar Mandantenfähigkeit</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode2002.jpg"/>
						<aside class="notes">
							<ul>
								<li>Intershop</li>
								<li>Rund zehn Jahre mit massivem Customizing</li>
								<li>"Dienstag ist Deployment-Tag"</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode2013.png"/>
						<aside class="notes">
							<ul>
								<li>2013</li>
								<li>Intershop-Ablösung</li>
								<li>In-House, EC-Bereich</li>
								<li>Lhotse-Projekt</li>
								<li>Keimzelle agile Transformation</li>
								<li>Vertikalen (bounded context, microfrontend)</li>
								<li>asynchrone Datenversorgung</li>
								<li>Deployments: wöchentlich bis täglich</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode2015.png"/>
						<!-- https://web.archive.org/web/20150414033045/https://www.otto.de/ -->
						<aside class="notes">
							<ul>
								<li>2015</li>
								<li>Mobile last</li>
								<li>Full responsive</li>
								<li>nochmal mehrere Jahre bis JQuery weg</li>
							</ul>
						</aside>
			    </section>
			    <section>
			      <img class="stretch" src="img/ottode2019.png"/>
						<aside class="notes">
							<ul>
								<li>Aktueller Screen (2019)</li>
								<li>Migration in die Cloud</li>
								<li>Ablösung einzelner Monolithen, Kunden Duzen</li>
								<li>mehrere hundert Deployments pro Tag</li>
							</ul>
							<ul>
								<li>MicroServices</li>
								<li>Server-to-Server-Kommunikation</li>
								<li>Viele Schnittstellen, viele Teams</li>
								<li>soooo.....</li>
							</ul>
						</aside>
			    </section>
				</section>

				<section id="motivation">
					<img data-src="Cdcs01.png">
					<aside class="notes">
						<ul>
							<li>Ein Team - ein Server</li>
							<li>Http-Request mit Response, die ausgewertet wird</li>
							<li>Kommunikation ist authentifiziert</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs02.png">
					<aside class="notes">
						Server hat Secret aus einem Secret Store
					</aside>
				</section>
				<section>
					<img data-src="Cdcs03.png">
					<aside class="notes">
						<ul>
							<li>Client hat Secret aus einem Secret Store</li>
							<li>Server-Team hat Spezifikation, Tests etc.</li>
							<li>Trotzdem Abhängigkeiten zu Implementierungsdetails</li>
							<ul>
								<li>IDs aus der Mongo => Timestamp</li>
								<li>Reihenfolge von XML oder JSON Elementen</li>
								<li>Neue Elemente</li>
								<li>Alte Elemente fallen weg</li>
							</ul>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist01.png">
					<aside class="notes">
						<ul>
							<li>Client-Team schreibt Test</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs10.png">
					<aside class="notes">
						<ul>
							<li>Test führt Request aus</li>
							<li>Interpretiert response</li>
							<li>NICHT</li>
							<ul>
								<li>Validierung</li>
								<li>Konkrete Inhalte</li>
								<li>Business-Logik</li>
							</ul>
							<li>Kann Response noch in Domain-Objekt übersetzt werden</li>
							<li>Test hat Secret aus einem Secret Store</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs11.png">
					<aside class="notes">
						<ul>
							<li>Relativ schnelles Feedback</li>
							<li>Ändert sich Client nicht, aber Server, dann kein Feedback</li>
							<li>Verhindert nicht den Livegang von Bugs</li>
							<li> ==> Test ist in falscher Pipeline</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist02.png">
				</section>
				<section>
					<img data-src="Cdcs12.png">
					<aside class="notes">
						<ul>
							<li>Client Test in ServerPipeline</li>
							<li>schnelles Feedback</li>
							<li>Verhindert den Livegang von Bugs</li>
							<li>Test hat Secret aus einem Secret Store</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs13.png">
					<aside class="notes">
						Client-Pipeline muss Test irgendwo für Server-Team bereitstellen
					</aside>
				</section>
				<section id="cdcTestVanilla">
					<img data-src="Cdcs14.png">
					<aside class="notes">
						Bereitstellen mit Artifactory
						<ul>
							<li>Passwort duplicates sind schlecht</li>
							<li>Runtime-Abhängigkeiten wie X11-Libs, Java- oder Docker-Version</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist03.png">
					<aside class="notes">
						<ul>
							<li>Aber insgesamt gut genug, so lange wir in Rechenzentrum waren</li>
							<li>Also insgesamt rund 6 Jahre</li>
							<li>Und im letzten Jahr sind wir mit dem ganzen Shop in die Cloud migriert</li>
						</ul>
					</aside>
				</section>
				<section id="byeNexinto">
					<img data-src="Cdcs20.png">
					<aside class="notes">
						<ul>
							<li>Client- und Server Maschinen gibt es immer noch</li>
							<li>Passworte auch</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs21.png">
					<aside class="notes">
						<ul>
							<li>Die Maschinen sind netzwerkseitig voneinander getrennt</li>
							<li>Requests von einer Maschine erreichen nicht die andere </li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs22.png">
					<aside class="notes">
						Dank Infrastructure-As-Code von Teams anpassbar:
						Gateways nutzen oder VPCs verknüpfen
					</aside>
				</section>
				<section>
					<img data-src="Cdcs23.png">
					<aside class="notes">
						<ul>
						<li>Und dann funktionieren die Requests auch wieder</li>
						<li>Versuch, CDCs einfach genauso wieder herzustellen</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs24.png">
					<aside class="notes">
						Mit den Pipelines
					</aside>
				</section>
				<section>
					<img data-src="Cdcs25.png">
					<aside class="notes">
						in ihren eigenen Netzwerkbereichen
					</aside>
				</section>
				<section>
					<img data-src="Cdcs30.png">
					<aside class="notes">
						<ul>
							<li>Das Test-Artefakt könnte z.B. via S3 ausgetauscht werden</li>
							<li>wenn beide Teams die nötigen Zugriffe haben</li>
							<li>Wessen Bucket? Bei uns häufig vom Client.</li>
						</ul>
					</aside>
				</section>
				<section id="cdcCloudProblem">
					<img data-src="Cdcs31.png">
					<aside class="notes">
						<ul>
							<li>Test-Request von der Pipeline muss separat freigeschaltet werden</li>
							<li>Ausgang von Pipeline ist nicht schlimm, wegen Dependency-Download von überall her</li>
							<li>Zugang zu Server-Netz ist schon blöd, weil nur für tests</li>
							<li>Server team muss inzwischen also schon
								<ul>
									<li>Riesiges Artefact downloaden</li>
									<li>Version ermitteln</li>
									<li>Laufzeit-Abhängigkeiten bereitstellen</li>
									<li>Passworte im Pipeline-Bereich ablegen</li>
									<li>Löcher in die Firewall bohren</li>
								</ul>
							</li>
							<li>Wieder mehr in Richtung Client-Team?</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist04.png">
				</section>
				<section>
					<img data-src="Cdcs40.png">
					<aside class="notes">
						<ul>
							<li>Den Test statt dessen als Lambda deployen</li>
							<li>Bei uns: Fat-Jar</li>
							<li>In den gleichen Netzwerk-Bereich wie die Client-Maschine</li>
							<li>Kein S3-Bucket, keine Berechtigungen darauf</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs41.png">
					<aside class="notes">
						<ul>
							<li>Die Lambda kann den gleichen Password-Store benutzen wie Client-Maschine</li>
							<li>Weil sie im gleichen Bereich liegt</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs42.png">
					<aside class="notes">
						<ul>
							<li>keine Password-Duplizierung mehr in Server-Pipeline</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs43.png">
					<aside class="notes">
						<ul>
							<li>Test-Request geht durch annähernd gleiche Strecke wie Client-Maschine</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs44.png">
					<aside class="notes">
						<ul>
							<li>Api-Gateway triggert Lambda</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="Cdcs45.png">
					<aside class="notes">
						<ul>
							<li>Pipeline triggert Api-Gateway</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist06.png">
				</section>
				<section>
					<img data-src="wishlist07.png">
				</section>
				<section>
					<img data-src="wishlist08.png">
				</section>
				<section>
					<img data-src="Cdcs46.png">
					<aside class="notes">
						<ul>
							<li>Bei uns statt Lambda DIREKT in Client-Maschine</li>
						</ul>
					</aside>
				</section>
				<section>
					<img data-src="wishlist09.png">
					<aside class="notes">
						Das war's. War's das?
				</section>
				<section id="offen">
					<h2>Ungeklärt</h2>
					<p>Schnittstellen ohne HTTP</p>
					<ul>
						<li>SNS</li>
						<li>SQS</li>
						<li>Kinesis</li>
						<li>Kafka</li>
					</ul>
				</section>
				<section id="danke">
					<h1>Danke.</h1>
					<p class="fragment">dev.otto.de</p>
				</section>
				<section>
					<h1>Fragen?</h1>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/title-footer/title-footer.js', async: true, callback: function() { title_footer.initialize(' ', 'no-repeat url("img/otto_logo_2015.png") center center;'); } }
				],
				transition: 'none',
				progress: true,
			});
		</script>
	</body>
</html>
